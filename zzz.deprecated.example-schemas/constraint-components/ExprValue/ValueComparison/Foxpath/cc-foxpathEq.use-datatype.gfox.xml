<?xml version="1.0" encoding="UTF-8"?>
<!-- 
    Demonstrates the use of constraint component ExprValueEq, using a Foxpath expression.
    An additional ExprValueCount constraint ensures that successful validation is not
    possible without evaluation of the ExprValueEq constraint.
    
    The schema checks that the rounded maximum of the decimal values found in a set of 
    files and at a given location is equal to a given value.
    
    This example uses a @useDatatype parameter: before comparing the expression value
    items with the value specified by @eq, both operands of the comparison are cast
    to the specified datatype, here xs:decimal.
    
    Constraint components:
    * Name:  ExprValueEq 
    - XML:   foxpath/(@expr, @eq) 
    - Check: Every item of the expression value must be equal to the value given by @eq.
    
    * Name:  ExprValueCount 
    - XML:   foxpath/(@expr, @minCount) 
    - Check: The number of value items must be equal to the number specified by @minCount.
-->
<greenfox greenfoxURI="http://www.greenfox.org/ns/schema-examples/demo-constraint-component/foxpath-value-eq.use-datatype"
          xmlns="http://www.greenfox.org/ns/schema">

    <context>
        <field name="domain" value="${schemaPath}\..\..\..\..\..\..\example-data"/>
    </context>
    
    <domain path="${domain}" name="greenfox-example-data">
        <folder foxpath="airports" id="airportsFolderShape">
            <targetSize countMsg="Missing folder: airports" count="1"/>     
            <!-- All value items must satisfy the condition -->            
            <foxpath expr="(denmark\airport-*.xml//latitude/xs:decimal(.) => max(., 3)) ! round(., 3)"
                     eq="57.504"
                     useDatatype="xs:decimal"
                     eqMsg="Airport description has not the expected type 'airport'"
                     count="1"
                     countMsg="Airport resources missing or not containing latitude information"/>
        </folder>
    </domain>

</greenfox>


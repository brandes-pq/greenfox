<?xml version="1.0" encoding="UTF-8"?>
<!-- 
    Demonstrates the use of constraint component ExprValueEq, using an XPath expression.
    An additional ExprValueMinCount constraint ensures that successful validation is
    not possible without evaluation of the ExprValueEq constraint.
    
    This example uses an expression yielding several value items, and no quantifier (@quant)
    is specified. As the default quantifier is 'all', successful validation requires that all
    items satisfy the condition. The same behaviour is obtained when using an attribute 
    @quant='all'.
    
    Constraint components:
    * Name:  ExprValueEq 
    - XML:   xpath/(@expr, @eq) 
    - Check: Every item of the expression value must be equal to the value given by @eq.
    
    * Name:  ExprValueMinCount 
    - XML:   xpath/(@expr, @minCount) 
    - Check: The number of value items must be at least the number specified by @minCount.
-->
<greenfox greenfoxURI="http://www.greenfox.org/ns/schema-examples/demo-constraint-component/xpath-value-eq.all-items"
          xmlns="http://www.greenfox.org/ns/schema">

    <context>
        <field name="domain" value="${schemaPath}\..\..\..\..\..\..\example-data"/>
    </context>
    
    <domain path="${domain}" name="greenfox-example-data">
        <folder foxpath="airports" id="airportsFolderShape">
            <targetSize countMsg="Missing folder: airports" count="1"/>            
            <file foxpath="airports.xml" id="airportsFileShape">
                <targetSize countMsg="Missing file: airports.xml" count="1"/>
                <xpath expr="//@href ! replace(., '.*/', '') ! substring-before(., '-')"
                       eq="airport"
                       eqMsg="Not expected airport reference"
                       minCount="2"
                       minCountMsg="Should contain at least @href attributes"/>
            </file>
        </folder>
    </domain>

</greenfox>

